"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7246],{5503:(M,D,c)=>{c.d(D,{D:()=>v});var C=c(6895),T=c(6738);let v=(()=>{class p{}return p.\u0275fac=function(S){return new(S||p)},p.\u0275mod=T.oAB({type:p}),p.\u0275inj=T.cJS({imports:[C.ez]}),p})()},6421:(M,D,c)=>{c.d(D,{F:()=>E});var C=c(2340),T=c(6738),v=c(529),p=c(3972);let E=(()=>{class S{constructor(i,n){this.http=i,this.state=n,this.SCHEDULES_API=C.N.schedulesAPI}getSchedules(){return this.http.get(this.SCHEDULES_API+"/schedule.json")}getSchoolYear(){return this.http.get(this.SCHEDULES_API+"/school-year.json")}determineSchedule(i,n,l){i=this.stripTime(i);let o=!1,r={currentSchedule:null};if(i<new Date(n.not_before)||i>new Date(n.not_after))return r.scheduleReason="School not in session",i>new Date(n.not_after)?(r.statusCode=-1,r):(r.statusCode=0,r);if(n.holidays.forEach(u=>{this.dateApplies(i,u)&&(r.scheduleReason="School Holiday",o=!0)}),o)return r.statusCode=0,r;for(let u=0;u<l.length;u++)if("dates"in l[u]&&l[u].dates.forEach(m=>{this.dateApplies(i,m)&&(r.currentSchedule=u,o=!0)}),o)return r.statusCode=3,r;for(let u=0;u<l.length;u++)if("applyDay"in l[u]&&l[u].applyDay.includes(i.getDay()))return r.currentSchedule=u,r.statusCode=2,r;return 6==i.getDay()||0==i.getDay()?(r.currentSchedule=null,r.scheduleReason="Weekend",r.statusCode=0,r):(r.currentSchedule=0,r.statusCode=1,r)}dateApplies(i,n){return n instanceof Array?i>=new Date(n[0])&&i<=new Date(n[1]):i.getTime()===new Date(n).getTime()}stripTime(i){return(i=new Date(i.getTime())).setHours(0),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0),i}subtractTime(i,n){let l=i.split(":"),o=n.split(":"),m=3600*Number(l[0])+60*Number(l[1])+Number(l[2])-(3600*Number(o[0])+60*Number(o[1])+Number(o[2])),g=[Math.floor(m/3600),Math.floor(m%3600/60),m%60],f=[];return g.forEach(I=>{let h=I.toString();f.push(h.length<2?"0"+h:h)}),f[0]+":"+f[1]+":"+f[2]}addTime(i,n){let l=i.split(":"),o=n.split(":"),m=3600*Number(l[0])+60*Number(l[1])+Number(l[2])+(3600*Number(o[0])+60*Number(o[1])+Number(o[2])),g=[Math.floor(m/3600),Math.floor(m%3600/60),m%60],f=[];return g.forEach(I=>{let h=I.toString();f.push(h.length<2?"0"+h:h)}),f[0]+":"+f[1]+":"+f[2]}periodCheck(i,n,l){let o=i.toLocaleTimeString([],{hour12:!1}),u=this.determineSchedule(i,n,l);if(this.state.setCurrentSchedule(l[u.currentSchedule]),null==u.currentSchedule)return{currentPeriod:u.scheduleReason};let m=l[u.currentSchedule].combinedAB||!1;for(let g=0;g<l[u.currentSchedule].schedule.length;g++){let f=l[u.currentSchedule].schedule[g],I=(4===f.startTime.length?"0":"")+f.startTime+":00",h=(4===f.endTime.length?"0":"")+f.endTime+":00";if(o<I&&0==g)return{currentPeriod:"School not started.",timeRemaining:this.subtractTime(I,o)};let A,x=l[u.currentSchedule].schedule[g+1]?l[u.currentSchedule].schedule[g+1]:null,w=f.name;if(m&&-1!=w.indexOf("/")&&(1===i.getDay()||3===i.getDay()?w=f.name.substring(0,1):(2===i.getDay()||4===i.getDay())&&(w=f.name.substring(2))),null!=x&&(A=x.name,m&&-1!=A.indexOf("/")&&(1===i.getDay()||3===i.getDay()?A=x.name.substring(0,1):(2===i.getDay()||4===i.getDay())&&(A=x.name.substring(2)))),o<h&&o>=I)return{currentPeriod:w,periodEndTime:h,timeRemaining:this.subtractTime(h+":00",o)};if(null!=x&&o>=h&&o<x.startTime)return{currentPeriod:"Between "+w+" and "+A,timeRemaining:this.subtractTime(x.startTime+":00",o)};if(null==x&&o>=h)return{currentPeriod:"School is released."}}}}return S.\u0275fac=function(i){return new(i||S)(T.LFG(v.eN),T.LFG(p.b))},S.\u0275prov=T.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"}),S})()},3972:(M,D,c)=>{c.d(D,{b:()=>W});var C=c(5861),T=c(591),v=c(8929),p=c(2654);class E extends p.w{constructor(e,t){super()}schedule(e,t=0){return this}}class S extends E{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const s=this.id,a=this.scheduler;return null!=s&&(this.id=this.recycleAsyncId(a,s,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(a,this.id,t),this}requestAsyncId(e,t,s=0){return setInterval(e.flush.bind(e,this),s)}recycleAsyncId(e,t,s=0){if(null!==s&&this.delay===s&&!1===this.pending)return t;clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const s=this._execute(e,t);if(s)return s;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let a,s=!1;try{this.work(e)}catch(b){s=!0,a=!!b&&b||new Error(b)}if(s)return this.unsubscribe(),a}_unsubscribe(){const e=this.id,t=this.scheduler,s=t.actions,a=s.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==a&&s.splice(a,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}let i=(()=>{class d{constructor(t,s=d.now){this.SchedulerAction=t,this.now=s}schedule(t,s=0,a){return new this.SchedulerAction(this,t).schedule(a,s)}}return d.now=()=>Date.now(),d})();class n extends i{constructor(e,t=i.now){super(e,()=>n.delegate&&n.delegate!==this?n.delegate.now():t()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(e,t=0,s){return n.delegate&&n.delegate!==this?n.delegate.schedule(e,t,s):super.schedule(e,t,s)}flush(e){const{actions:t}=this;if(this.active)return void t.push(e);let s;this.active=!0;do{if(s=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,s){for(;e=t.shift();)e.unsubscribe();throw s}}}const r=new class l extends n{}(class P extends S{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,s=0){return null!==s&&s>0||null===s&&this.delay>0?super.requestAsyncId(e,t,s):e.flush(this)}});var u=c(3489),m=c(8896),g=c(1086),f=c(1737);class h{constructor(e,t,s){this.kind=e,this.value=t,this.error=s,this.hasValue="N"===e}observe(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}do(e,t,s){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return s&&s()}}accept(e,t,s){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,s)}toObservable(){switch(this.kind){case"N":return(0,g.of)(this.value);case"E":return(0,f._)(this.error);case"C":return(0,m.c)()}throw new Error("unexpected notification kind value")}static createNext(e){return typeof e<"u"?new h("N",e):h.undefinedValueNotification}static createError(e){return new h("E",void 0,e)}static createComplete(){return h.completeNotification}}h.completeNotification=new h("C"),h.undefinedValueNotification=new h("N",void 0);class w extends u.L{constructor(e,t,s=0){super(e),this.scheduler=t,this.delay=s}static dispatch(e){const{notification:t,destination:s}=e;t.observe(s),this.unsubscribe()}scheduleMessage(e){this.destination.add(this.scheduler.schedule(w.dispatch,this.delay,new R(e,this.destination)))}_next(e){this.scheduleMessage(h.createNext(e))}_error(e){this.scheduleMessage(h.createError(e)),this.unsubscribe()}_complete(){this.scheduleMessage(h.createComplete()),this.unsubscribe()}}class R{constructor(e,t){this.notification=e,this.destination=t}}var _=c(5279),F=c(5283);class K extends v.xQ{constructor(e=Number.POSITIVE_INFINITY,t=Number.POSITIVE_INFINITY,s){super(),this.scheduler=s,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=e<1?1:e,this._windowTime=t<1?1:t,t===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(e){if(!this.isStopped){const t=this._events;t.push(e),t.length>this._bufferSize&&t.shift()}super.next(e)}nextTimeWindow(e){this.isStopped||(this._events.push(new B(this._getNow(),e)),this._trimBufferThenGetEvents()),super.next(e)}_subscribe(e){const t=this._infiniteTimeWindow,s=t?this._events:this._trimBufferThenGetEvents(),a=this.scheduler,b=s.length;let N;if(this.closed)throw new _.N;if(this.isStopped||this.hasError?N=p.w.EMPTY:(this.observers.push(e),N=new F.W(this,e)),a&&e.add(e=new w(e,a)),t)for(let y=0;y<b&&!e.closed;y++)e.next(s[y]);else for(let y=0;y<b&&!e.closed;y++)e.next(s[y].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),N}_getNow(){return(this.scheduler||r).now()}_trimBufferThenGetEvents(){const e=this._getNow(),t=this._bufferSize,s=this._windowTime,a=this._events,b=a.length;let N=0;for(;N<b&&!(e-a[N].time<s);)N++;return b>t&&(N=Math.max(N,b-t)),N>0&&a.splice(0,N),a}}class B{constructor(e,t){this.time=e,this.value=t}}var O=c(6738),L=c(849);let W=(()=>{class d{constructor(t){this.db=t,this.PREFERENCES_KEY="app-preferences",this.preferences=new T.X({twentyfour:!1,bells:!1}),this.currentSchedule=new K(1),this.initStorage(),t.get(this.PREFERENCES_KEY).then(s=>{s?this.preferences.next(s):t.set(this.PREFERENCES_KEY,this.preferences.getValue())})}initStorage(){var t=this;return(0,C.Z)(function*(){yield t.db.create()})()}getPreferences(){return this.preferences.asObservable()}setPreferences(t){this.db.set(this.PREFERENCES_KEY,this.preferences).then(()=>this.preferences.next(t))}setPreference(t,s){let a=this.preferences.getValue();a[t]=s,this.db.set(this.PREFERENCES_KEY,a).then(()=>this.preferences.next(a))}getCurrentSchedule(){return this.currentSchedule.asObservable()}setCurrentSchedule(t){this.currentSchedule.next(t)}}return d.\u0275fac=function(t){return new(t||d)(O.LFG(L.K))},d.\u0275prov=O.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},9775:(M,D,c)=>{c.d(D,{x:()=>T});var C=c(6738);let T=(()=>{class v{transform(E,S){let P="";if(!S&&E){let i=E.indexOf(":"),n=Number(E.substring(0,i));return P+=String(n>12?n-12:n),P+=E.substring(i),P+=n>=12?"p":"a",P}return E}}return v.\u0275fac=function(E){return new(E||v)},v.\u0275pipe=C.Yjl({name:"timeFormat",type:v,pure:!0}),v})()}}]);