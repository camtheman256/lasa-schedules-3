!function(){function e(t,n,r){return(e="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(t,n,r||t)}function t(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function r(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var u=s(this).constructor;n=Reflect.construct(r,arguments,u)}else n=r.apply(this,arguments);return i(this,n)}}function i(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(self.webpackChunklasa_schedules=self.webpackChunklasa_schedules||[]).push([[7246],{5503:function(e,t,n){"use strict";n.d(t,{D:function(){return u}});var r=n(8583),i=n(639),u=function(){var e=function e(){a(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=i.oAB({type:e}),e.\u0275inj=i.cJS({imports:[[r.ez]]}),e}()},6421:function(e,t,n){"use strict";n.d(t,{F:function(){return o}});var r=n(2340),i=n(639),u=n(1841),s=n(6370),o=function(){var e=function(){function e(t,n){a(this,e),this.http=t,this.state=n,this.SCHEDULES_API=r.N.schedulesAPI}return c(e,[{key:"getSchedules",value:function(){return this.http.get(this.SCHEDULES_API+"/schedule.json")}},{key:"getSchoolYear",value:function(){return this.http.get(this.SCHEDULES_API+"/school-year.json")}},{key:"determineSchedule",value:function(e,t,n){var r=this;e=this.stripTime(e);var i=!1,u={currentSchedule:null};if(e<new Date(t.not_before)||e>new Date(t.not_after))return u.scheduleReason="School not in session",e>new Date(t.not_after)?(u.statusCode=-1,u):(u.statusCode=0,u);if(t.holidays.forEach(function(t){r.dateApplies(e,t)&&(u.scheduleReason="School Holiday",i=!0)}),i)return u.statusCode=0,u;for(var s=function(t){if("dates"in n[t]&&n[t].dates.forEach(function(n){r.dateApplies(e,n)&&(u.currentSchedule=t,i=!0)}),i)return{v:(u.statusCode=3,u)}},o=0;o<n.length;o++){var c=s(o);if("object"==typeof c)return c.v}for(var a=0;a<n.length;a++)if("applyDay"in n[a]&&n[a].applyDay.includes(e.getDay()))return u.currentSchedule=a,u.statusCode=2,u;return 6==e.getDay()||0==e.getDay()?(u.currentSchedule=null,u.scheduleReason="Weekend",u.statusCode=0,u):(u.currentSchedule=0,u.statusCode=1,u)}},{key:"dateApplies",value:function(e,t){return t instanceof Array?e>=new Date(t[0])&&e<=new Date(t[1]):e.getTime()===new Date(t).getTime()}},{key:"stripTime",value:function(e){return(e=new Date(e.getTime())).setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e}},{key:"subtractTime",value:function(e,t){var n=e.split(":"),r=t.split(":"),i=3600*Number(n[0])+60*Number(n[1])+Number(n[2])-(3600*Number(r[0])+60*Number(r[1])+Number(r[2])),u=[Math.floor(i/3600),Math.floor(i%3600/60),i%60],s=[];return u.forEach(function(e){var t=e.toString();s.push(t.length<2?"0"+t:t)}),s[0]+":"+s[1]+":"+s[2]}},{key:"addTime",value:function(e,t){var n=e.split(":"),r=t.split(":"),i=3600*Number(n[0])+60*Number(n[1])+Number(n[2])+(3600*Number(r[0])+60*Number(r[1])+Number(r[2])),u=[Math.floor(i/3600),Math.floor(i%3600/60),i%60],s=[];return u.forEach(function(e){var t=e.toString();s.push(t.length<2?"0"+t:t)}),s[0]+":"+s[1]+":"+s[2]}},{key:"periodCheck",value:function(e,t,n){var r=e.toLocaleTimeString([],{hour12:!1}),i=this.determineSchedule(e,t,n);if(this.state.setCurrentSchedule(n[i.currentSchedule]),null==i.currentSchedule)return{currentPeriod:i.scheduleReason};for(var u=n[i.currentSchedule].combinedAB||!1,s=0;s<n[i.currentSchedule].schedule.length;s++){var o=n[i.currentSchedule].schedule[s],c=(4===o.startTime.length?"0":"")+o.startTime+":00",a=(4===o.endTime.length?"0":"")+o.endTime+":00";if(r<c&&0==s)return{currentPeriod:"School not started.",timeRemaining:this.subtractTime(c,r)};var h=void 0,l=n[i.currentSchedule].schedule[s+1]?n[i.currentSchedule].schedule[s+1]:null,f=o.name;if(u&&-1!=f.indexOf("/")&&(1===e.getDay()||3===e.getDay()?f=o.name.substring(0,1):2!==e.getDay()&&4!==e.getDay()||(f=o.name.substring(2))),null!=l&&(h=l.name,u&&-1!=h.indexOf("/")&&(1===e.getDay()||3===e.getDay()?h=l.name.substring(0,1):2!==e.getDay()&&4!==e.getDay()||(h=l.name.substring(2)))),r<a&&r>=c)return{currentPeriod:f,periodEndTime:a,timeRemaining:this.subtractTime(a+":00",r)};if(null!=l&&r>=a&&r<l.startTime)return{currentPeriod:"Between "+f+" and "+h,timeRemaining:this.subtractTime(l.startTime+":00",r)};if(null==l&&r>=a)return{currentPeriod:"School is released."}}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(i.LFG(u.eN),i.LFG(s.b))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},6370:function(n,i,o){"use strict";o.d(i,{b:function(){return C}});var h=o(4762),l=o(9765),f=o(5319),d=function(e){t(i,e);var n=r(i);function i(e,t){var r;return a(this,i),(r=n.call(this,e,t)).scheduler=e,r.work=t,r.pending=!1,r}return c(i,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}},{key:"requestAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return setInterval(e.flush.bind(e,this),n)}},{key:"recycleAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)}},{key:"execute",value:function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}},{key:"_execute",value:function(e,t){var n,r=!1;try{this.work(e)}catch(i){r=!0,n=!!i&&i||new Error(i)}if(r)return this.unsubscribe(),n}},{key:"_unsubscribe",value:function(){var e=this.id,t=this.scheduler,n=t.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}]),i}(function(e){t(i,e);var n=r(i);function i(e,t){return a(this,i),n.call(this)}return c(i,[{key:"schedule",value:function(e){return this}}]),i}(f.w)),v=function(){var e=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.now;a(this,e),this.SchedulerAction=t,this.now=n}return c(e,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return new this.SchedulerAction(this,e).schedule(n,t)}}]),e}();return e.now=function(){return Date.now()},e}(),p=new(function(e){t(i,e);var n=r(i);function i(){return a(this,i),n.apply(this,arguments)}return i}(function(n){t(o,n);var i=r(o);function o(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v.now;return a(this,o),(t=i.call(this,e,function(){return o.delegate&&o.delegate!==u(t)?o.delegate.now():n()})).actions=[],t.active=!1,t.scheduled=void 0,t}return c(o,[{key:"schedule",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;return o.delegate&&o.delegate!==this?o.delegate.schedule(t,n,r):e(s(o.prototype),"schedule",this).call(this,t,n,r)}},{key:"flush",value:function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}}]),o}(v)))(function(n){t(u,n);var i=r(u);function u(e,t){var n;return a(this,u),(n=i.call(this,e,t)).scheduler=e,n.work=t,n}return c(u,[{key:"schedule",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return n>0?e(s(u.prototype),"schedule",this).call(this,t,n):(this.delay=n,this.state=t,this.scheduler.flush(this),this)}},{key:"execute",value:function(t,n){return n>0||this.closed?e(s(u.prototype),"execute",this).call(this,t,n):this._execute(t,n)}},{key:"requestAsyncId",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!==r&&r>0||null===r&&this.delay>0?e(s(u.prototype),"requestAsyncId",this).call(this,t,n,r):t.flush(this)}}]),u}(d)),y=o(7393),g=o(9193),m=o(5917),b=o(7574),w=function(){function e(t,n,r){a(this,e),this.kind=t,this.value=n,this.error=r,this.hasValue="N"===t}return c(e,[{key:"observe",value:function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}},{key:"do",value:function(e,t,n){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return n&&n()}}},{key:"accept",value:function(e,t,n){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,n)}},{key:"toObservable",value:function(){switch(this.kind){case"N":return(0,m.of)(this.value);case"E":return e=this.error,new b.y(function(t){return t.error(e)});case"C":return(0,g.c)()}var e;throw new Error("unexpected notification kind value")}}],[{key:"createNext",value:function(t){return void 0!==t?new e("N",t):e.undefinedValueNotification}},{key:"createError",value:function(t){return new e("E",void 0,t)}},{key:"createComplete",value:function(){return e.completeNotification}}]),e}();w.completeNotification=new w("C"),w.undefinedValueNotification=new w("N",void 0);var k=function(e){t(i,e);var n=r(i);function i(e,t){var r,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return a(this,i),(r=n.call(this,e)).scheduler=t,r.delay=u,r}return c(i,[{key:"scheduleMessage",value:function(e){this.destination.add(this.scheduler.schedule(i.dispatch,this.delay,new E(e,this.destination)))}},{key:"_next",value:function(e){this.scheduleMessage(w.createNext(e))}},{key:"_error",value:function(e){this.scheduleMessage(w.createError(e)),this.unsubscribe()}},{key:"_complete",value:function(){this.scheduleMessage(w.createComplete()),this.unsubscribe()}}],[{key:"dispatch",value:function(e){var t=e.notification,n=e.destination;t.observe(n),this.unsubscribe()}}]),i}(y.L),E=function e(t,n){a(this,e),this.notification=t,this.destination=n},S=o(7971),_=o(8858),N=function(n){t(u,n);var i=r(u);function u(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.POSITIVE_INFINITY,r=arguments.length>2?arguments[2]:void 0;return a(this,u),(e=i.call(this)).scheduler=r,e._events=[],e._infiniteTimeWindow=!1,e._bufferSize=t<1?1:t,e._windowTime=n<1?1:n,n===Number.POSITIVE_INFINITY?(e._infiniteTimeWindow=!0,e.next=e.nextInfiniteTimeWindow):e.next=e.nextTimeWindow,e}return c(u,[{key:"nextInfiniteTimeWindow",value:function(t){if(!this.isStopped){var n=this._events;n.push(t),n.length>this._bufferSize&&n.shift()}e(s(u.prototype),"next",this).call(this,t)}},{key:"nextTimeWindow",value:function(t){this.isStopped||(this._events.push(new x(this._getNow(),t)),this._trimBufferThenGetEvents()),e(s(u.prototype),"next",this).call(this,t)}},{key:"_subscribe",value:function(e){var t,n=this._infiniteTimeWindow,r=n?this._events:this._trimBufferThenGetEvents(),i=this.scheduler,u=r.length;if(this.closed)throw new S.N;if(this.isStopped||this.hasError?t=f.w.EMPTY:(this.observers.push(e),t=new _.W(this,e)),i&&e.add(e=new k(e,i)),n)for(var s=0;s<u&&!e.closed;s++)e.next(r[s]);else for(var o=0;o<u&&!e.closed;o++)e.next(r[o].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),t}},{key:"_getNow",value:function(){return(this.scheduler||p).now()}},{key:"_trimBufferThenGetEvents",value:function(){for(var e=this._getNow(),t=this._bufferSize,n=this._windowTime,r=this._events,i=r.length,u=0;u<i&&!(e-r[u].time<n);)u++;return i>t&&(u=Math.max(u,i-t)),u>0&&r.splice(0,u),r}}]),u}(l.xQ),x=function e(t,n){a(this,e),this.time=t,this.value=n},T=o(6215),I=o(639),P=o(1628),C=function(){var e=function(){function e(t){var n=this;a(this,e),this.db=t,this.PREFERENCES_KEY="app-preferences",this.preferences=new T.X({twentyfour:!1,bells:!1}),this.currentSchedule=new N(1),this.initStorage(),t.get(this.PREFERENCES_KEY).then(function(e){e?n.preferences.next(e):t.set(n.PREFERENCES_KEY,n.preferences.getValue())})}return c(e,[{key:"initStorage",value:function(){return(0,h.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.db.create();case 2:case"end":return e.stop()}},e,this)}))}},{key:"getPreferences",value:function(){return this.preferences.asObservable()}},{key:"setPreferences",value:function(e){var t=this;this.db.set(this.PREFERENCES_KEY,this.preferences).then(function(){return t.preferences.next(e)})}},{key:"setPreference",value:function(e,t){var n=this,r=this.preferences.getValue();r[e]=t,this.db.set(this.PREFERENCES_KEY,r).then(function(){return n.preferences.next(r)})}},{key:"getCurrentSchedule",value:function(){return this.currentSchedule.asObservable()}},{key:"setCurrentSchedule",value:function(e){this.currentSchedule.next(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(I.LFG(P.K))},e.\u0275prov=I.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},9775:function(e,t,n){"use strict";n.d(t,{x:function(){return i}});var r=n(639),i=function(){var e=function(){function e(){a(this,e)}return c(e,[{key:"transform",value:function(e,t){var n="";if(!t&&e){var r=e.indexOf(":"),i=Number(e.substring(0,r));return n+=String(i>12?i-12:i),n+=e.substring(r),n+=i>=12?"p":"a"}return e}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=r.Yjl({name:"timeFormat",type:e,pure:!0}),e}()}}])}();